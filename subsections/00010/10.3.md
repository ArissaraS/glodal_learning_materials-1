# 10.3 Composing time-series data and interpretation of ALOS data to identify changes
This section introduces participants to ......

## Content:
- 10.3.1 Creating the time-series data 
- 10.3.2 Interpreting time-series data to identify temporal changes 

## 10.3.1 Creating the time-series data 

### a. [The Complete Guide to Time Series Forecasting Models](https://medium.com/@wainaina.pierre/the-complete-guide-to-time-series-forecasting-models-ef9c8cd40037)

This website provides a comprehensive overview of Time Series Forecasting. It explains how to analyze data that changes over time, using statistical models to make predictions about future trends.

Learners wil understand the points below from this content:
1. **Time Series Data Characteristics:** Data points are ordered chronologically, and each observation is dependent on the previous one. Understanding trends, seasonality, and noise helps in analyzing the data.
2. **Importance of Stationarity:** Stationary data, where properties like mean and variance stay constant, is easier to analyze. Stationarity ensures that statistical models, such as ARIMA, perform accurately.
3. **Time Series Models:** Several models like AR, MA, ARIMA, SARIMA, and machine learning models (RNNs, LSTMs) are used to capture patterns and predict future values. Each model is suitable for different types of time series data (e.g., with or without seasonality or trends).
4. **Model Evaluation:** Metrics such as MAE, RMSE, and MAPE help in assessing the accuracy of these models. Cross-validation techniques ensure models generalize well to new data.
5. **Python vs. R:** Both languages are effective for time series forecasting. Python is more versatile, especially for machine learning, while R excels in statistical modeling and visualization.

### b. [Time-Series Analysis of Satellite Data: Unveiling Trends and Patterns](https://flypix.ai/blog/time-series-analysis-of-satellite-data-unveiling-trends-and-patterns/)

The article on time-series analysis of satellite data:
1. **Understanding Changes Over Time:** Time-series analysis of satellite imagery helps monitor and interpret changes in the Earth's surface, such as vegetation, water bodies, and infrastructure, by analyzing images captured at regular intervals over a period of time.
2. **Applications in Environmental and Urban Monitoring:** This technique is valuable for various applications like monitoring vegetation health (using indices like NDVI), detecting deforestation, assessing sea level rise, coastal erosion, and analyzing urbanization trends and land use changes.
3. **Disaster Response and Recovery:** Time-series analysis is crucial for assessing the impact of natural disasters. It helps emergency responders and policymakers allocate resources, plan recovery efforts, and make informed decisions on infrastructure rebuilding and long-term recovery.
4. **Challenges in Data Analysis:** The process faces challenges like ensuring the quality of satellite imagery, managing large datasets with high computational demands, and requiring domain expertise for accurate interpretation of trends.
5. **Future Potential and Technological Advancements:** As technology advances, time-series analysis will continue to improve, offering deeper insights into environmental and societal changes. Platforms like FlyPix AI aim to simplify and enhance this analysis, enabling organizations to make data-driven decisions.

### c. [Creating time-series data from ALOS-2 imagery]()

For this tutorial, we provide hands-on guidance on how to prepare time-series data from ALOS-2 imagery. This hands-on provided step-by-step instructions to prepare time-series data from ALOS-2 imagery in Python.

The code processes ALOS-2 satellite images by loading an Area of Interest (AOI) shapefile and a list of image paths, followed by a series of steps for each image: clipping it to the AOI, applying calibration using a logarithmic transformation, and filtering with a Lee filter. Each processed image—original clipped, calibrated, and filtered—is visualized side by side for comparison. The filtered images are resized to a common shape to ensure consistency, and they are then stacked into a multi-band GeoTIFF file. Finally, the stacked image is saved to a specified output path, allowing for further analysis of the time-series data.

- [Hands-on guidance for prepare_time-series_data_from_ALOS-2_imagery](code/10.3.Prepare_time-series_data_from_ALOS-2_imagery.ipynb)

**The guidance on how to prepare time-series data from ALOS-2 imagery**

Preparing time-series data from ALOS-2 imagery involves processing multiple images taken at different times and aligning them to analyze changes over time. These steps will allow you to create a consistent and analyzable time-series dataset from ALOS-2 imagery, enabling the identification of temporal trends and changes within your AOI. Here are the detailed steps to prepare and analyze time-series data from ALOS-2 imagery:

**Step 1: Collect and Organize ALOS-2 Images**
Gather all ALOS-2 images of the area of interest (AOI) taken over the desired time period. Ensure all images have consistent polarization channels (e.g., HH, HV) and are aligned with the same projection. Organize them in a folder structure where each file represents a different timestamp.

Additional option:
Clipping to Area of Interest (AOI): You may want to clip the image to a specific geographic area using a shapefile or geoJSON.

**Step 2: Load ALOS-2 Data**
Load the ALOS-2 SAR image data into your processing environment. The data often comes in GeoTIFF format with multiple polarization bands (like HH, HV, VH, and VV). In this case, we will use the alos-2 on HH polarization.

**Step 3: Calibrate Images**

Apply Radiometric calibration factors to convert digital numbers to backscatter values. Apply the calibration formula 20*log10(band) - 83 to each band of each image. This step ensures consistency in data interpretation across time.

Radiometric calibration is crucial for converting ALOS-2 SAR data into physically meaningful values (like backscatter) that accurately represent the reflectivity of the Earth's surface. It ensures that the data is corrected for sensor biases, comparable across different sensors or acquisition times, and suitable for detailed analysis like environmental monitoring, land use classification, and disaster management.

![FOMULA for calib](image-4.png)

![Example of Calibrate Images](image-3.png)

Reference: [Calibration Result of ALOS-2/PALSAR-2 JAXA Standard Products](https://www.eorc.jaxa.jp/ALOS-2/en/calval/calval_index.htm)

**Step 4: Apply Speckle Filtering**

Reduce speckle noise across the time-series images to make the time-series analysis more robust. Apply a Lee filter to each calibrated band. Filtering helps to smooth out noise and is especially useful for visualizing temporal changes.

**Step 5: Stack Images into a Time-Series**

Composing a time-series stack involves combining multiple ALOS-2 images from different dates into a single multi-layer image. This way, each layer represents data from a specific date, allowing you to analyze temporal changes.

Combine all normalized images into a single 3D array (time-series cube) for time-based analysis. Each layer represents a different year, creating a consistent data cube for analysis. The array will be structured as (time, width, height).

**Step 6: Analyze and Visualize Temporal Changes**

Perform temporal analysis, such as change detection, trend analysis, or time-series visualization. You can calculate differences, detect significant changes, or plot the values over time for specific areas within the AOI. Visualization can be done using libraries like matplotlib.


## 10.3.2 Interpreting time-series data to identify temporal changes

### Analyzing time-series data to identify changes in container operations and port activity

Stacking ALOS-2 images involves combining multiple SAR images taken over the same area but at different times into a single multi-layered file. This stacked image allows you to analyze changes over time within the area of interest (AOI).

- [Hands-on activities for analyzing time-series data to identify changes](code/10.3.2.Analyzing time-series data to identify changes.ipynb)

Multi-Temporal Analysis: Each layer in the stack represents a different time point. The stacked file includes images from 2019, 2020, 2021 and 2022. By stacking these images, it can compare and analyze changes in surface properties or other factors affecting radar backscatter over time.

![alos2_time_series_stack_nagoya](image-5.png)

To analyze the time-series stacked data and identify big changes in the stacking layer for each year, with an output that indicates when the area has changed, we need to follow these steps:

1. Load the time-series stack: Read the multi-temporal ALOS-2 data.
2. Compute changes: Calculate the difference between consecutive years.
3. Identify significant changes: Set a threshold to identify large changes and determine the year of change.
4. Label changes by year: For each pixel, assign the year it changed based on the first time it crosses the threshold.
5. Apply a Median Filter to Remove Noise: Smooths out small noise patches while preserving larger changes.
6. Generate an output mask: Create a mask where pixels indicate the year in which a significant change occurred.

![identify changes in the staking layer](image-8.png)

Notes:
You can experiment with the size parameter in the median filter to remove more or less noise depending on the nature of your data.

### Interpret changes and visualize trends using graphs


**Explanation for analyzing time-series data to identify changes**

The numbers you see in the output (0-6) represent the time period or layer index in which a significant change occurred within the ALOS-2 time-series stack. Based on the stacked ALOS-2 imagery (alos2_time_series_stack_ngo.tif), these numbers are mapped to different years. Since the stack consists of multiple layers, with each layer corresponding to a specific year or time period, the values represent when a change was detected between consecutive layers. 

Here’s the interpretation of output values ranging from 0-6 represent the following:

0: This indicates no change occurred throughout the time-series for that pixel. If a pixel has a value of 0, it means that the pixel didn't undergo any significant change according to the threshold set.

1 to 6: These numbers indicate the year (or time period) when the change occurred. Since your alos2_time_series_stack_ngo.tif contains multiple time layers (likely corresponding to different years), the values represent the time layer index when a significant change first occurred.

Here’s what each number represents:

1. Change occurred between Year 1 and Year 2 (first change).
2. Change occurred between Year 2 and Year 3.
3. Change occurred between Year 3 and Year 4.
4. Change occurred between Year 4 and Year 5.
5. Change occurred between Year 5 and Year 6.
6. Change occurred between Year 6 and Year 7 (last change).

The numbers correlate to the year index, starting from 1 for the first observed change and up to 6 for the last observed change (depending on how many years or bands you have in the stack).


We can create graphs based on the mean values extracted from the change locations in layer stacking, using the change area output. The general approach is to:

Extract the locations where changes occurred from the change area output.
For each time layer in the stack, extract the pixel values from those locations.
Calculate the mean value of the pixels in the change area for each layer.
Visualize the mean values over time using a line plot.